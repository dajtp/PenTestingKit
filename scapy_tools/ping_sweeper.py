import scapy.all as scapy
import argparse
import os
import sys
import time
import datetime


def main():
    first_3_octets = input("Enter the first 3 octets of the IP address (e.g. 10.0.0): ")
    range_start = int(input("Enter the starting range: "))
    range_end = int(input("Enter the ending range: "))
    port = int(input("Enter the port to scan: "))

    target_ip_array = []
    for i in range(range_start, range_end + 1):
        target_ip_array.append(first_3_octets + "." + str(i))
    #print(target_ip_array)

    for target_ip in target_ip_array:
        print("Sending packet to " + target_ip)
        packet = scapy.IP(dst=target_ip) / scapy.TCP(dport=port, flags='S')
        response = scapy.sr1(packet, timeout=1, verbose=0)
        if response:
            print("Received response from " + response.src)
            print(response)
            print("\n")
        else:
            print("No response received\n")
    
    print("\nScan complete")
        

if __name__ == "__main__":
    main()